---
sidebar_position: 2
slug: ssh-config
title: MacBook SSH é…ç½®æŒ‡å—
id: ssh-config
description: å®Œæ•´çš„ MacBook SSH å¯†é’¥é…ç½®æŒ‡å—ï¼Œå¤šè´¦æˆ·ç®¡ç†å’Œå¸¸è§é—®é¢˜è§£å†³æ–¹æ¡ˆ
---

# MacBook SSH é…ç½®æŒ‡å—

## ğŸ“‹ æ¦‚è¿°

æœ¬æŒ‡å—å°†å¸®åŠ©ä½ åœ¨ MacBook ä¸Šé…ç½® SSH å¯†é’¥ï¼Œä»¥ä¾¿å®‰å…¨åœ°è¿æ¥ GitHub ç­‰ Git æœåŠ¡ã€‚é€šè¿‡ SSH å¯†é’¥ï¼Œä½ å¯ä»¥å…å¯†è¿›è¡Œ Git æ“ä½œï¼Œæé«˜å¼€å‘æ•ˆç‡ã€‚

:::tip ä¸ºä»€ä¹ˆä½¿ç”¨ SSHï¼Ÿ
SSH å¯†é’¥æ¯”å¯†ç æ›´å®‰å…¨ï¼Œæ”¯æŒå…å¯†æ“ä½œï¼Œç‰¹åˆ«é€‚åˆé¢‘ç¹çš„ Git æ“ä½œåœºæ™¯ã€‚
:::

## ğŸ”§ å‰ç½®æ¡ä»¶

- macOS ç³»ç»Ÿ
- å·²å®‰è£… Git
- æ‹¥æœ‰ GitHub è´¦æˆ·
- ç»ˆç«¯è®¿é—®æƒé™

:::warning é‡è¦æé†’
ç¡®ä¿ä½ æœ‰ç®¡ç†å‘˜æƒé™æ¥ä¿®æ”¹ç³»ç»Ÿé…ç½®æ–‡ä»¶ã€‚
:::

## ğŸš€ é…ç½®æ­¥éª¤

### 1. ç”Ÿæˆ SSH å¯†é’¥

```bash title="ç”ŸæˆSSHå¯†é’¥"
# è¿›å…¥ SSH ç›®å½•
cd ~/.ssh

# ç”Ÿæˆæ–°çš„ SSH å¯†é’¥å¯¹
ssh-keygen -t rsa -C "your-email@example.com"
```

**è¯´æ˜ï¼š**
- `-t rsa`ï¼šæŒ‡å®šå¯†é’¥ç±»å‹ä¸º RSA
- `-C "email"`ï¼šæ·»åŠ æ³¨é‡Šï¼Œé€šå¸¸æ˜¯ä½ çš„é‚®ç®±åœ°å€
- æŒ‰å›è½¦ä½¿ç”¨é»˜è®¤æ–‡ä»¶åï¼Œæˆ–è¾“å…¥è‡ªå®šä¹‰æ–‡ä»¶å
- è®¾ç½®å¯†ç ï¼ˆå¯é€‰ï¼Œå»ºè®®è®¾ç½®ï¼‰

:::info å¯†é’¥ç±»å‹é€‰æ‹©
- **RSA**: å…¼å®¹æ€§å¥½ï¼Œæ¨èç”¨äºä¸€èˆ¬ç”¨é€”
- **Ed25519**: æ›´å®‰å…¨ï¼Œæ€§èƒ½æ›´å¥½ï¼Œä½†éœ€è¦è¾ƒæ–°çš„ç³»ç»Ÿæ”¯æŒ
:::

### 2. é…ç½® SSH Config æ–‡ä»¶

```bash title="ç¼–è¾‘SSHé…ç½®"
# ç¼–è¾‘ SSH é…ç½®æ–‡ä»¶
vi ~/.ssh/config
```

åœ¨é…ç½®æ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š

```bash title="~/.ssh/config"
# GitHub é…ç½®
Host github
    HostName github.com
    User git
    IdentityFile ~/.ssh/id_rsa  # ä½ çš„ç§é’¥æ–‡ä»¶è·¯å¾„

# å¦‚æœæœ‰å¤šä¸ª GitHub è´¦æˆ·ï¼Œå¯ä»¥è¿™æ ·é…ç½®
Host github-work
    HostName github.com
    User git
    IdentityFile ~/.ssh/work_rsa

Host github-personal
    HostName github.com
    User git
    IdentityFile ~/.ssh/personal_rsa
```

### 3. æ·»åŠ å¯†é’¥åˆ° SSH Agent

```bash title="SSH Agenté…ç½®"

# æ·»åŠ ç§é’¥åˆ° SSH Agent
ssh-add ~/.ssh/id_rsa

# å¦‚æœæœ‰å¤šä¸ªå¯†é’¥ï¼Œåˆ†åˆ«æ·»åŠ 
ssh-add ~/.ssh/work_rsa
ssh-add ~/.ssh/personal_rsa
```

:::tip è‡ªåŠ¨å¯åŠ¨SSH Agent
å¯ä»¥å°†ä»¥ä¸‹å†…å®¹æ·»åŠ åˆ° `~/.zshrc` æˆ– `~/.bash_profile` ä¸­ï¼Œå®ç°è‡ªåŠ¨å¯åŠ¨ï¼š

```bash
# è‡ªåŠ¨å¯åŠ¨ SSH Agent å¹¶æ·»åŠ å¯†é’¥
if [ -z "$SSH_AUTH_SOCK" ]; then
    eval "$(ssh-agent -s)"
    ssh-add ~/.ssh/id_rsa
fi
```
:::

### 4. é…ç½® GitHub SSH

#### 4.1 è·å–å…¬é’¥

```bash title="æŸ¥çœ‹å…¬é’¥"
# æŸ¥çœ‹å…¬é’¥å†…å®¹
cat ~/.ssh/id_rsa.pub
```

#### 4.2 æ·»åŠ å…¬é’¥åˆ° GitHub

1. è®¿é—® [GitHub SSH è®¾ç½®é¡µé¢](https://github.com/settings/keys)
2. ç‚¹å‡» "New SSH key"
3. è¾“å…¥æ ‡é¢˜ï¼ˆå¦‚ï¼šMacBook Proï¼‰
4. å°†å…¬é’¥å†…å®¹ç²˜è´´åˆ° "Key" å­—æ®µ
5. ç‚¹å‡» "Add SSH key"

### 5. å…‹éš†ä»“åº“

```bash title="SSHå…‹éš†ä»“åº“"
# ä½¿ç”¨ SSH å…‹éš†ä»“åº“
git clone git@github:username/repository.git

# æˆ–è€…ä½¿ç”¨é…ç½®çš„åˆ«å
git clone git@github-work:company/repository.git
```

## âœ… éªŒè¯é…ç½®

### æ£€æŸ¥ SSH è¿æ¥

```bash title="æµ‹è¯•SSHè¿æ¥"
# æµ‹è¯• GitHub è¿æ¥
ssh -T git@github.com
```

å¦‚æœé…ç½®æˆåŠŸï¼Œä¼šçœ‹åˆ°ç±»ä¼¼ä¿¡æ¯ï¼š
```
Hi username! You've successfully authenticated, but GitHub does not provide shell access.
```

### æŸ¥çœ‹å·²æ·»åŠ çš„å¯†é’¥

```bash title="æŸ¥çœ‹SSHå¯†é’¥"
# åˆ—å‡ºæ‰€æœ‰å·²æ·»åŠ çš„ SSH å¯†é’¥
ssh-add -l

# æŸ¥çœ‹å¯†é’¥æŒ‡çº¹
ssh-add -L
```

## â“ å¸¸è§é—®é¢˜è§£ç­”

### Q1: æƒé™è¢«æ‹’ç» (Permission denied)

**é—®é¢˜ï¼š** å…‹éš†æˆ–æ¨é€æ—¶å‡ºç°æƒé™é”™è¯¯

**è§£å†³æ–¹æ¡ˆï¼š**

1. æ£€æŸ¥ SSH å¯†é’¥æ˜¯å¦åœ¨ agent ä¸­ï¼š
   ```bash
   ssh-add -l
   ```

2. å¦‚æœæ²¡æœ‰ï¼Œé‡æ–°æ·»åŠ ï¼š
   ```bash
   ssh-add ~/.ssh/id_rsa
   ```

3. æ£€æŸ¥ GitHub ä¸Šçš„å…¬é’¥æ˜¯å¦æ­£ç¡®æ·»åŠ 

4. éªŒè¯ SSH è¿æ¥ï¼š
   ```bash
   ssh -T git@github.com
   ```

:::warning æƒé™é—®é¢˜æ’æŸ¥
å¦‚æœä»ç„¶æœ‰é—®é¢˜ï¼Œæ£€æŸ¥æ–‡ä»¶æƒé™ï¼š
```bash
chmod 600 ~/.ssh/id_rsa
chmod 644 ~/.ssh/id_rsa.pub
```
:::

### Q2: å¤šä¸ª GitHub è´¦æˆ·å†²çª

**é—®é¢˜ï¼š** éœ€è¦åŒæ—¶ä½¿ç”¨å¤šä¸ª GitHub è´¦æˆ·

**è§£å†³æ–¹æ¡ˆï¼š**

1. ä¸ºæ¯ä¸ªè´¦æˆ·ç”Ÿæˆä¸åŒçš„å¯†é’¥
2. åœ¨ `~/.ssh/config` ä¸­é…ç½®ä¸åŒçš„ Host
3. å…‹éš†æ—¶ä½¿ç”¨å¯¹åº”çš„ Host åˆ«å

```bash title="å¤šè´¦æˆ·é…ç½®ç¤ºä¾‹"
# å·¥ä½œè´¦æˆ·
Host github-work
    HostName github.com
    User git
    IdentityFile ~/.ssh/work_rsa

# ä¸ªäººè´¦æˆ·
Host github-personal
    HostName github.com
    User git
    IdentityFile ~/.ssh/personal_rsa
```

### Q3: SSH Agent é‡å¯åå¯†é’¥ä¸¢å¤±

**é—®é¢˜ï¼š** é‡å¯åéœ€è¦é‡æ–°æ·»åŠ å¯†é’¥

**è§£å†³æ–¹æ¡ˆï¼š**

åœ¨ `~/.zshrc` æˆ– `~/.bash_profile` ä¸­æ·»åŠ ï¼š

```bash title="è‡ªåŠ¨å¯åŠ¨SSH Agent"
# è‡ªåŠ¨å¯åŠ¨ SSH Agent å¹¶æ·»åŠ å¯†é’¥
if [ -z "$SSH_AUTH_SOCK" ]; then
    eval "$(ssh-agent -s)"
    ssh-add ~/.ssh/id_rsa
fi
```

## ğŸ“ æ³¨æ„äº‹é¡¹

- ğŸ” **å®‰å…¨æé†’**ï¼šç§é’¥æ–‡ä»¶ (`id_rsa`) ç»å¯¹ä¸èƒ½æ³„éœ²ç»™ä»–äºº
- ğŸ”„ **å¤‡ä»½**ï¼šå»ºè®®å¤‡ä»½ SSH å¯†é’¥åˆ°å®‰å…¨ä½ç½®
- ğŸ·ï¸ **å‘½åè§„èŒƒ**ï¼šä¸ºä¸åŒç”¨é€”çš„å¯†é’¥ä½¿ç”¨æœ‰æ„ä¹‰çš„æ–‡ä»¶å
- ğŸ” **å®šæœŸæ£€æŸ¥**ï¼šå®šæœŸæ£€æŸ¥ GitHub ä¸Šçš„ SSH å¯†é’¥åˆ—è¡¨ï¼Œåˆ é™¤ä¸å†ä½¿ç”¨çš„å¯†é’¥

