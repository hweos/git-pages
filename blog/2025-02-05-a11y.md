---
slug: accessibility-guide
title: 无障碍 (a11y) 开发指南
authors: mason
tags: [无障碍, a11y, 前端, 用户体验]
---

无障碍设计让所有用户都能使用你的应用。本文介绍 Web 无障碍的核心概念和实践方法。

<!--truncate-->

## 🎯 什么是 Web 无障碍

Web 无障碍 (Accessibility, 简称 a11y) 确保残障人士也能：

- 感知内容
- 理解信息
- 导航操作
- 贡献内容

### 受益人群

```markdown
- 视觉障碍（失明、色盲、低视力）
- 听觉障碍（耳聋、听力下降）
- 运动障碍（无法使用鼠标）
- 认知障碍（阅读困难）
- 临时障碍（手受伤、环境嘈杂）
- 老年用户
```

---

## 📋 WCAG 指南

WCAG (Web Content Accessibility Guidelines) 四大原则：

| 原则 | 英文 | 说明 |
|------|------|------|
| 可感知 | Perceivable | 用户能感知内容 |
| 可操作 | Operable | 用户能操作界面 |
| 可理解 | Understandable | 用户能理解内容 |
| 健壮性 | Robust | 兼容各种辅助技术 |

---

## 🏗️ 语义化 HTML

### 使用正确的标签

```html
<!-- ❌ 不好 -->
<div class="header">
  <div class="nav">
    <div class="nav-item" onclick="navigate()">首页</div>
  </div>
</div>
<div class="main">
  <div class="article">
    <div class="title">文章标题</div>
  </div>
</div>

<!-- ✅ 好 -->
<header>
  <nav>
    <a href="/">首页</a>
  </nav>
</header>
<main>
  <article>
    <h1>文章标题</h1>
  </article>
</main>
```

### 标题层级

```html
<!-- ❌ 跳过层级 -->
<h1>页面标题</h1>
<h3>小节标题</h3>

<!-- ✅ 正确层级 -->
<h1>页面标题</h1>
<h2>章节标题</h2>
<h3>小节标题</h3>
```

### 列表

```html
<!-- 无序列表 -->
<ul>
  <li>项目一</li>
  <li>项目二</li>
</ul>

<!-- 有序列表 -->
<ol>
  <li>步骤一</li>
  <li>步骤二</li>
</ol>

<!-- 描述列表 -->
<dl>
  <dt>HTML</dt>
  <dd>超文本标记语言</dd>
</dl>
```

---

## 🖼️ 图片无障碍

### alt 属性

```html
<!-- 信息性图片：描述内容 -->
<img src="chart.png" alt="2024年销售额柱状图，Q4最高达100万">

<!-- 装饰性图片：空alt -->
<img src="decoration.png" alt="">

<!-- 功能性图片：描述功能 -->
<button>
  <img src="search.svg" alt="搜索">
</button>

<!-- 复杂图片：详细描述 -->
<figure>
  <img src="infographic.png" alt="公司组织架构图" aria-describedby="org-desc">
  <figcaption id="org-desc">
    公司分为三个部门：技术部、市场部、运营部...
  </figcaption>
</figure>
```

---

## ⌨️ 键盘导航

### 焦点管理

```css
/* 保留焦点样式 */
:focus {
  outline: 2px solid #3b82f6;
  outline-offset: 2px;
}

/* 只在键盘导航时显示 */
:focus:not(:focus-visible) {
  outline: none;
}

:focus-visible {
  outline: 2px solid #3b82f6;
}
```

### tabindex

```html
<!-- 自然可聚焦元素 -->
<a href="#">链接</a>
<button>按钮</button>
<input type="text">

<!-- 添加到 Tab 顺序 -->
<div tabindex="0">可聚焦的 div</div>

<!-- 可聚焦但不在 Tab 顺序中 -->
<div tabindex="-1">程序控制焦点</div>

<!-- ❌ 避免正数 tabindex -->
<div tabindex="1">不推荐</div>
```

### 跳过链接

```html
<body>
  <a href="#main-content" class="skip-link">
    跳到主要内容
  </a>
  <header>...</header>
  <main id="main-content">...</main>
</body>

<style>
.skip-link {
  position: absolute;
  top: -40px;
  left: 0;
  padding: 8px;
  background: #000;
  color: #fff;
  z-index: 100;
}

.skip-link:focus {
  top: 0;
}
</style>
```

---

## 🏷️ ARIA 属性

### 角色 (role)

```html
<!-- 地标角色 -->
<div role="banner">页头</div>
<div role="navigation">导航</div>
<div role="main">主内容</div>
<div role="complementary">侧边栏</div>

<!-- 组件角色 -->
<div role="button" tabindex="0">自定义按钮</div>
<div role="dialog" aria-modal="true">模态框</div>
<ul role="tablist">
  <li role="tab">标签1</li>
</ul>
```

### 状态和属性

```html
<!-- 展开状态 -->
<button aria-expanded="false" aria-controls="menu">
  菜单
</button>
<ul id="menu" hidden>...</ul>

<!-- 选中状态 -->
<div role="checkbox" aria-checked="true">已选中</div>

<!-- 禁用状态 -->
<button aria-disabled="true">禁用按钮</button>

<!-- 描述关联 -->
<input 
  type="text" 
  aria-label="搜索"
  aria-describedby="search-hint"
>
<span id="search-hint">输入关键词搜索文章</span>
```

### 实时区域

```html
<!-- 通知更新 -->
<div aria-live="polite">
  表单已保存
</div>

<!-- 紧急通知 -->
<div aria-live="assertive" role="alert">
  操作失败，请重试
</div>
```

---

## 📝 表单无障碍

### 标签关联

```html
<!-- 显式关联 -->
<label for="email">邮箱</label>
<input type="email" id="email">

<!-- 隐式关联 -->
<label>
  邮箱
  <input type="email">
</label>

<!-- 隐藏标签 -->
<label for="search" class="visually-hidden">搜索</label>
<input type="search" id="search" placeholder="搜索...">
```

### 错误提示

```html
<div>
  <label for="email">邮箱</label>
  <input 
    type="email" 
    id="email"
    aria-invalid="true"
    aria-describedby="email-error"
  >
  <span id="email-error" role="alert">
    请输入有效的邮箱地址
  </span>
</div>
```

### 必填字段

```html
<label for="name">
  姓名 <span aria-hidden="true">*</span>
</label>
<input type="text" id="name" required aria-required="true">
```

---

## 🎨 颜色和对比度

### 对比度要求

```markdown
WCAG AA 级别：
- 正常文本：4.5:1
- 大文本（18px+ 或 14px 粗体）：3:1

WCAG AAA 级别：
- 正常文本：7:1
- 大文本：4.5:1
```

### 不只依赖颜色

```html
<!-- ❌ 只用颜色表示状态 -->
<span style="color: red">错误</span>
<span style="color: green">成功</span>

<!-- ✅ 颜色 + 图标/文字 -->
<span style="color: red">❌ 错误</span>
<span style="color: green">✓ 成功</span>
```

---

## 🛠️ 测试工具

| 工具 | 用途 |
|------|------|
| axe DevTools | 自动化检测 |
| Lighthouse | 综合评分 |
| WAVE | 可视化问题 |
| 屏幕阅读器 | 真实体验 |
| 键盘测试 | Tab 导航 |

### 自动化测试

```javascript
// jest-axe
import { axe, toHaveNoViolations } from 'jest-axe';

expect.extend(toHaveNoViolations);

test('should have no accessibility violations', async () => {
  const { container } = render(<MyComponent />);
  const results = await axe(container);
  expect(results).toHaveNoViolations();
});
```

---

## ✅ 检查清单

```markdown
结构：
- [ ] 使用语义化 HTML
- [ ] 正确的标题层级
- [ ] 地标区域

图片：
- [ ] 所有图片有 alt
- [ ] 装饰图片 alt 为空

键盘：
- [ ] 可 Tab 导航
- [ ] 焦点可见
- [ ] 有跳过链接

表单：
- [ ] 标签关联
- [ ] 错误提示
- [ ] 必填标识

颜色：
- [ ] 对比度达标
- [ ] 不只依赖颜色
```

---

无障碍不是额外的工作，而是好设计的一部分。从项目开始就考虑无障碍，比后期修复更容易。
