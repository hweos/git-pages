---
slug: h5-mobile-development
title: ç§»åŠ¨ç«¯ H5 å¼€å‘æŠ€å·§
authors: mason
tags: [H5, ç§»åŠ¨ç«¯, å‰ç«¯]
---

ç§»åŠ¨ç«¯ H5 å¼€å‘æœ‰è®¸å¤šå‘å’ŒæŠ€å·§ã€‚æœ¬æ–‡æ€»ç»“ç§»åŠ¨ç«¯å¼€å‘çš„å¸¸è§é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆã€‚

<!--truncate-->

## ğŸ“± è§†å£é…ç½®

### åŸºç¡€é…ç½®

```html
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

<!-- iOS ç›¸å…³ -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="default">
<meta name="format-detection" content="telephone=no, email=no">
```

### å®‰å…¨åŒºåŸŸ

```css
/* é€‚é… iPhone åˆ˜æµ·å± */
body {
  padding-top: env(safe-area-inset-top);
  padding-bottom: env(safe-area-inset-bottom);
  padding-left: env(safe-area-inset-left);
  padding-right: env(safe-area-inset-right);
}

/* å›ºå®šåº•éƒ¨æ  */
.bottom-bar {
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  padding-bottom: env(safe-area-inset-bottom);
}
```

---

## ğŸ“ ç§»åŠ¨ç«¯é€‚é…

### rem æ–¹æ¡ˆ

```javascript
// åŠ¨æ€è®¾ç½®æ ¹å­—ä½“å¤§å°
function setRem() {
  const width = document.documentElement.clientWidth;
  const fontSize = width / 375 * 16; // ä»¥ 375 ä¸ºåŸºå‡†
  document.documentElement.style.fontSize = `${fontSize}px`;
}

setRem();
window.addEventListener('resize', setRem);
```

```css
/* ä½¿ç”¨ rem */
.container {
  width: 23.4375rem; /* 375px */
  padding: 1rem;     /* 16px */
}
```

### vw æ–¹æ¡ˆ

```css
/* ç›´æ¥ä½¿ç”¨ vw */
.container {
  width: 100vw;
  padding: 4.267vw; /* 16/375*100 */
}

/* PostCSS æ’ä»¶è‡ªåŠ¨è½¬æ¢ */
/* postcss-px-to-viewport */
.container {
  width: 375px; /* è‡ªåŠ¨è½¬ä¸º 100vw */
  padding: 16px; /* è‡ªåŠ¨è½¬ä¸º 4.267vw */
}
```

---

## ğŸ‘† è§¦æ‘¸äº‹ä»¶

### ç‚¹å‡»ç©¿é€

```javascript
// é—®é¢˜ï¼šç‚¹å‡»å 300ms å»¶è¿Ÿ
// è§£å†³æ–¹æ¡ˆ 1ï¼šfastclick
import FastClick from 'fastclick';
FastClick.attach(document.body);

// è§£å†³æ–¹æ¡ˆ 2ï¼štouch-action
.button {
  touch-action: manipulation;
}

// è§£å†³æ–¹æ¡ˆ 3ï¼šä½¿ç”¨ touchend
element.addEventListener('touchend', (e) => {
  e.preventDefault();
  handleClick();
});
```

### æ»‘åŠ¨æ“ä½œ

```javascript
let startX, startY;

element.addEventListener('touchstart', (e) => {
  startX = e.touches[0].clientX;
  startY = e.touches[0].clientY;
});

element.addEventListener('touchend', (e) => {
  const endX = e.changedTouches[0].clientX;
  const endY = e.changedTouches[0].clientY;
  
  const deltaX = endX - startX;
  const deltaY = endY - startY;
  
  if (Math.abs(deltaX) > Math.abs(deltaY)) {
    if (deltaX > 50) {
      console.log('å³æ»‘');
    } else if (deltaX < -50) {
      console.log('å·¦æ»‘');
    }
  }
});
```

---

## ğŸ“œ æ»šåŠ¨é—®é¢˜

### å¼¹æ€§æ»šåŠ¨

```css
/* iOS å¼¹æ€§æ»šåŠ¨ */
.scroll-container {
  -webkit-overflow-scrolling: touch;
  overflow-y: auto;
}
```

### ç¦æ­¢é¡µé¢æ»šåŠ¨

```javascript
// å¼¹çª—æ—¶ç¦æ­¢èƒŒæ™¯æ»šåŠ¨
function preventScroll(prevent) {
  if (prevent) {
    document.body.style.overflow = 'hidden';
    document.body.style.position = 'fixed';
    document.body.style.width = '100%';
  } else {
    document.body.style.overflow = '';
    document.body.style.position = '';
    document.body.style.width = '';
  }
}
```

### æ»šåŠ¨ç©¿é€

```css
/* å¼¹çª—å®¹å™¨ */
.modal {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  overflow: hidden;
}

/* å¼¹çª—å†…å®¹å¯æ»šåŠ¨ */
.modal-content {
  max-height: 80vh;
  overflow-y: auto;
  overscroll-behavior: contain;
}
```

---

## âŒ¨ï¸ è¾“å…¥æ¡†é—®é¢˜

### è½¯é”®ç›˜é®æŒ¡

```javascript
// è¾“å…¥æ¡†è·å¾—ç„¦ç‚¹æ—¶æ»šåŠ¨åˆ°å¯è§†åŒºåŸŸ
input.addEventListener('focus', () => {
  setTimeout(() => {
    input.scrollIntoView({ behavior: 'smooth', block: 'center' });
  }, 300);
});
```

### iOS è¾“å…¥æ¡†æ”¾å¤§

```css
/* å­—ä½“å°äº 16px ä¼šè§¦å‘æ”¾å¤§ */
input, textarea, select {
  font-size: 16px;
}
```

### é”®ç›˜æ”¶èµ·

```javascript
// ç‚¹å‡»å…¶ä»–åŒºåŸŸæ”¶èµ·é”®ç›˜
document.addEventListener('touchstart', (e) => {
  if (!e.target.matches('input, textarea')) {
    document.activeElement?.blur();
  }
});
```

---

## ğŸ–¼ï¸ å›¾ç‰‡å¤„ç†

### é«˜æ¸…å±é€‚é…

```html
<!-- 2x/3x å›¾ç‰‡ -->
<img 
  src="image.png"
  srcset="image@2x.png 2x, image@3x.png 3x"
  alt="å›¾ç‰‡"
>

<!-- picture æ ‡ç­¾ -->
<picture>
  <source media="(min-resolution: 3dppx)" srcset="image@3x.png">
  <source media="(min-resolution: 2dppx)" srcset="image@2x.png">
  <img src="image.png" alt="å›¾ç‰‡">
</picture>
```

### å›¾ç‰‡æ‡’åŠ è½½

```html
<img data-src="image.jpg" class="lazyload" alt="å›¾ç‰‡">

<script>
const observer = new IntersectionObserver((entries) => {
  entries.forEach(entry => {
    if (entry.isIntersecting) {
      const img = entry.target;
      img.src = img.dataset.src;
      observer.unobserve(img);
    }
  });
});

document.querySelectorAll('.lazyload').forEach(img => {
  observer.observe(img);
});
</script>
```

---

## ğŸ¨ 1px è¾¹æ¡†

```css
/* é—®é¢˜ï¼šç§»åŠ¨ç«¯ 1px çœ‹èµ·æ¥å¾ˆç²— */

/* æ–¹æ¡ˆ 1ï¼štransform */
.border-1px {
  position: relative;
}

.border-1px::after {
  content: '';
  position: absolute;
  left: 0;
  bottom: 0;
  width: 100%;
  height: 1px;
  background: #ddd;
  transform: scaleY(0.5);
  transform-origin: 0 0;
}

/* æ–¹æ¡ˆ 2ï¼šbox-shadow */
.border-1px {
  box-shadow: 0 1px 0 0 #ddd;
}

/* æ–¹æ¡ˆ 3ï¼šviewport ç¼©æ”¾ */
<meta name="viewport" content="width=device-width, initial-scale=0.5">
```

---

## ğŸ“± è®¾å¤‡åˆ¤æ–­

```javascript
// åˆ¤æ–­è®¾å¤‡
const isIOS = /iPhone|iPad|iPod/i.test(navigator.userAgent);
const isAndroid = /Android/i.test(navigator.userAgent);
const isWeChat = /MicroMessenger/i.test(navigator.userAgent);

// åˆ¤æ–­æ˜¯å¦æ˜¯ç§»åŠ¨ç«¯
const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);

// åˆ¤æ–­æ¨ªç«–å±
function getOrientation() {
  return window.innerWidth > window.innerHeight ? 'landscape' : 'portrait';
}

window.addEventListener('orientationchange', () => {
  console.log('Orientation:', getOrientation());
});
```

---

## ğŸ”— å”¤èµ· APP

```javascript
// é€šç”¨æ–¹æ¡ˆ
function openApp(schemeUrl, downloadUrl) {
  const iframe = document.createElement('iframe');
  iframe.style.display = 'none';
  iframe.src = schemeUrl;
  document.body.appendChild(iframe);

  setTimeout(() => {
    document.body.removeChild(iframe);
    // æ²¡æœ‰å”¤èµ·åˆ™è·³è½¬ä¸‹è½½
    window.location.href = downloadUrl;
  }, 2000);
}

// ä½¿ç”¨
openApp('myapp://path/to/page', 'https://app.example.com/download');
```

```html
<!-- Universal Links (iOS) -->
<a href="https://app.example.com/path">æ‰“å¼€ APP</a>

<!-- App Links (Android) -->
<a href="intent://path#Intent;scheme=myapp;package=com.example.app;end">æ‰“å¼€ APP</a>
```

---

## ğŸ› ï¸ è°ƒè¯•å·¥å…·

| å·¥å…· | ç”¨é€” |
|------|------|
| vConsole | ç§»åŠ¨ç«¯è°ƒè¯•é¢æ¿ |
| eruda | ç§»åŠ¨ç«¯è°ƒè¯•é¢æ¿ |
| Chrome è¿œç¨‹è°ƒè¯• | Android è®¾å¤‡ |
| Safari å¼€å‘è€…å·¥å…· | iOS è®¾å¤‡ |
| Charles/Fiddler | æŠ“åŒ… |

### vConsole ä½¿ç”¨

```javascript
import VConsole from 'vconsole';

if (process.env.NODE_ENV === 'development') {
  new VConsole();
}
```

---

## âœ… æ£€æŸ¥æ¸…å•

```markdown
- [ ] viewport æ­£ç¡®é…ç½®
- [ ] å®‰å…¨åŒºåŸŸé€‚é…
- [ ] 1px è¾¹æ¡†å¤„ç†
- [ ] å›¾ç‰‡é«˜æ¸…é€‚é…
- [ ] è½¯é”®ç›˜å¤„ç†
- [ ] æ»šåŠ¨ç©¿é€å¤„ç†
- [ ] ç‚¹å‡»å»¶è¿Ÿå¤„ç†
- [ ] è®¾å¤‡å…¼å®¹æµ‹è¯•
```

---

ç§»åŠ¨ç«¯ H5 å¼€å‘ç»†èŠ‚å¾ˆå¤šï¼Œå¤šåœ¨çœŸæœºä¸Šæµ‹è¯•ï¼Œé‡åˆ°é—®é¢˜å–„ç”¨æœç´¢ã€‚
