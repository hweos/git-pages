---
slug: regex-practical-guide
title: æ­£åˆ™è¡¨è¾¾å¼å®æˆ˜æŠ€å·§
authors: mason
tags: [æ­£åˆ™è¡¨è¾¾å¼, JavaScript, å·¥å…·]
---

æ­£åˆ™è¡¨è¾¾å¼æ˜¯æ–‡æœ¬å¤„ç†çš„å¼ºå¤§å·¥å…·ã€‚æœ¬æ–‡é€šè¿‡å®ä¾‹è®²è§£å¸¸ç”¨æ­£åˆ™æ¨¡å¼å’ŒæŠ€å·§ã€‚

<!--truncate-->

## ğŸ“ åŸºç¡€è¯­æ³•

### å­—ç¬¦åŒ¹é…

| æ¨¡å¼ | å«ä¹‰ | ç¤ºä¾‹ |
|------|------|------|
| `.` | ä»»æ„å­—ç¬¦ï¼ˆé™¤æ¢è¡Œï¼‰ | `a.c` â†’ abc, adc |
| `\d` | æ•°å­— [0-9] | `\d+` â†’ 123 |
| `\w` | å•è¯å­—ç¬¦ [a-zA-Z0-9_] | `\w+` â†’ hello_123 |
| `\s` | ç©ºç™½å­—ç¬¦ | `a\sb` â†’ a b |
| `\D` | éæ•°å­— | `\D+` â†’ abc |
| `\W` | éå•è¯å­—ç¬¦ | `\W+` â†’ @#$ |
| `\S` | éç©ºç™½ | `\S+` â†’ hello |

### é‡è¯

| æ¨¡å¼ | å«ä¹‰ | ç¤ºä¾‹ |
|------|------|------|
| `*` | 0 æ¬¡æˆ–å¤šæ¬¡ | `ab*c` â†’ ac, abc, abbc |
| `+` | 1 æ¬¡æˆ–å¤šæ¬¡ | `ab+c` â†’ abc, abbc |
| `?` | 0 æ¬¡æˆ– 1 æ¬¡ | `ab?c` â†’ ac, abc |
| `{n}` | æ°å¥½ n æ¬¡ | `a{3}` â†’ aaa |
| `{n,}` | è‡³å°‘ n æ¬¡ | `a{2,}` â†’ aa, aaa |
| `{n,m}` | n åˆ° m æ¬¡ | `a{2,4}` â†’ aa, aaa, aaaa |

### è¾¹ç•Œ

| æ¨¡å¼ | å«ä¹‰ |
|------|------|
| `^` | å­—ç¬¦ä¸²å¼€å¤´ |
| `$` | å­—ç¬¦ä¸²ç»“å°¾ |
| `\b` | å•è¯è¾¹ç•Œ |
| `\B` | éå•è¯è¾¹ç•Œ |

### åˆ†ç»„ä¸å¼•ç”¨

```javascript
// æ•è·ç»„
/(ab)+/           // åŒ¹é… ab, abab, ababab

// éæ•è·ç»„
/(?:ab)+/         // åŒ¹é…ä½†ä¸æ•è·

// å‘½åæ•è·ç»„
/(?<year>\d{4})-(?<month>\d{2})/

// åå‘å¼•ç”¨
/(\w+)\s+\1/      // åŒ¹é…é‡å¤å•è¯: "the the"
```

---

## ğŸ¯ å¸¸ç”¨æ¨¡å¼

### é‚®ç®±éªŒè¯

```javascript
// ç®€å•ç‰ˆ
const emailSimple = /^\S+@\S+\.\S+$/;

// å®Œæ•´ç‰ˆ
const email = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;

// æµ‹è¯•
email.test('user@example.com');  // true
email.test('invalid-email');     // false
```

### æ‰‹æœºå·éªŒè¯

```javascript
// ä¸­å›½å¤§é™†æ‰‹æœºå·
const phone = /^1[3-9]\d{9}$/;

phone.test('13800138000');  // true
phone.test('12345678901');  // false
```

### URL åŒ¹é…

```javascript
const url = /^(https?:\/\/)?([\w-]+\.)+[\w-]+(\/[\w-./?%&=]*)?$/;

url.test('https://example.com');           // true
url.test('http://sub.example.com/path');   // true
```

### å¯†ç å¼ºåº¦

```javascript
// è‡³å°‘8ä½ï¼ŒåŒ…å«å¤§å°å†™å­—æ¯å’Œæ•°å­—
const password = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[a-zA-Z\d]{8,}$/;

// å¸¦ç‰¹æ®Šå­—ç¬¦
const strongPassword = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$/;
```

### IP åœ°å€

```javascript
// IPv4
const ipv4 = /^((25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(25[0-5]|2[0-4]\d|[01]?\d\d?)$/;

ipv4.test('192.168.1.1');   // true
ipv4.test('256.1.1.1');     // false
```

### ä¸­æ–‡åŒ¹é…

```javascript
// åŒ¹é…ä¸­æ–‡å­—ç¬¦
const chinese = /[\u4e00-\u9fa5]+/;

// ä»…ä¸­æ–‡
const onlyChinese = /^[\u4e00-\u9fa5]+$/;

chinese.test('ä½ å¥½ä¸–ç•Œ');  // true
```

---

## ğŸ”§ JavaScript æ–¹æ³•

### test() - æµ‹è¯•åŒ¹é…

```javascript
const regex = /hello/i;
regex.test('Hello World');  // true
```

### match() - è·å–åŒ¹é…

```javascript
const str = 'The rain in Spain';
str.match(/ain/g);  // ['ain', 'ain']

// æ•è·ç»„
'2024-01-15'.match(/(\d{4})-(\d{2})-(\d{2})/);
// ['2024-01-15', '2024', '01', '15']

// å‘½åæ•è·ç»„
'2024-01-15'.match(/(?<year>\d{4})-(?<month>\d{2})-(?<day>\d{2})/);
// groups: { year: '2024', month: '01', day: '15' }
```

### replace() - æ›¿æ¢

```javascript
// ç®€å•æ›¿æ¢
'hello world'.replace(/world/, 'regex');  // 'hello regex'

// å…¨å±€æ›¿æ¢
'aaa'.replace(/a/g, 'b');  // 'bbb'

// ä½¿ç”¨æ•è·ç»„
'John Smith'.replace(/(\w+)\s(\w+)/, '$2, $1');  // 'Smith, John'

// å‡½æ•°æ›¿æ¢
'hello'.replace(/./g, (char) => char.toUpperCase());  // 'HELLO'
```

### split() - åˆ†å‰²

```javascript
'a, b,  c'.split(/,\s*/);  // ['a', 'b', 'c']
```

### matchAll() - è¿­ä»£æ‰€æœ‰åŒ¹é…

```javascript
const str = 'test1test2test3';
const matches = str.matchAll(/test(\d)/g);

for (const match of matches) {
  console.log(match[0], match[1]);
}
// test1 1
// test2 2
// test3 3
```

---

## ğŸ’¡ å®æˆ˜æŠ€å·§

### 1. è´ªå©ª vs æ‡’æƒ°

```javascript
const str = '<div>content</div>';

// è´ªå©ªï¼ˆé»˜è®¤ï¼‰- å°½å¯èƒ½å¤šåŒ¹é…
str.match(/<.*>/);    // ['<div>content</div>']

// æ‡’æƒ° - å°½å¯èƒ½å°‘åŒ¹é…
str.match(/<.*?>/);   // ['<div>']
```

### 2. å…ˆè¡Œæ–­è¨€

```javascript
// æ­£å‘å…ˆè¡Œæ–­è¨€ (?=)
// åŒ¹é…åé¢è·Ÿç€ç‰¹å®šå†…å®¹çš„
'100px 200em'.match(/\d+(?=px)/g);  // ['100']

// è´Ÿå‘å…ˆè¡Œæ–­è¨€ (?!)
// åŒ¹é…åé¢ä¸è·Ÿç€ç‰¹å®šå†…å®¹çš„
'100px 200em'.match(/\d+(?!px)/g);  // ['10', '200']
```

### 3. åè¡Œæ–­è¨€

```javascript
// æ­£å‘åè¡Œæ–­è¨€ (?<=)
// åŒ¹é…å‰é¢æ˜¯ç‰¹å®šå†…å®¹çš„
'$100 â‚¬200'.match(/(?<=\$)\d+/g);   // ['100']

// è´Ÿå‘åè¡Œæ–­è¨€ (?<!)
// åŒ¹é…å‰é¢ä¸æ˜¯ç‰¹å®šå†…å®¹çš„
'$100 â‚¬200'.match(/(?<!\$)\d+/g);   // ['00', '200']
```

### 4. æå–æ•°æ®

```javascript
// æå–æ‰€æœ‰é“¾æ¥
const html = '<a href="url1">text</a><a href="url2">text</a>';
const links = [...html.matchAll(/href="([^"]+)"/g)].map(m => m[1]);
// ['url1', 'url2']

// æå–æŸ¥è¯¢å‚æ•°
const url = 'https://example.com?name=john&age=25';
const params = Object.fromEntries(
  [...url.matchAll(/(\w+)=(\w+)/g)].map(m => [m[1], m[2]])
);
// { name: 'john', age: '25' }
```

### 5. æ ¼å¼åŒ–

```javascript
// åƒåˆ†ä½
'1234567'.replace(/\B(?=(\d{3})+(?!\d))/g, ',');  // '1,234,567'

// æ‰‹æœºå·è„±æ•
'13800138000'.replace(/(\d{3})\d{4}(\d{4})/, '$1****$2');  // '138****8000'

// é©¼å³°è½¬çŸ­æ¨ªçº¿
'backgroundColor'.replace(/([A-Z])/g, '-$1').toLowerCase();  // 'background-color'

// çŸ­æ¨ªçº¿è½¬é©¼å³°
'background-color'.replace(/-(\w)/g, (_, c) => c.toUpperCase());  // 'backgroundColor'
```

---

## ğŸš« å¸¸è§é™·é˜±

### 1. è½¬ä¹‰ç‰¹æ®Šå­—ç¬¦

```javascript
// è¿™äº›å­—ç¬¦éœ€è¦è½¬ä¹‰: . * + ? ^ $ { } [ ] ( ) | \
const regex = /\[.*\]/;        // åŒ¹é… [xxx]
const regex2 = /\$\d+\.\d+/;   // åŒ¹é… $10.99
```

### 2. æ­£åˆ™å®ä¾‹çš„ lastIndex

```javascript
const regex = /a/g;
const str = 'aaa';

regex.test(str);  // true, lastIndex = 1
regex.test(str);  // true, lastIndex = 2
regex.test(str);  // true, lastIndex = 3
regex.test(str);  // false, lastIndex = 0

// è§£å†³æ–¹æ¡ˆï¼šæ¯æ¬¡åˆ›å»ºæ–°å®ä¾‹æˆ–ä¸ä½¿ç”¨ g æ ‡å¿—
```

### 3. æ€§èƒ½é—®é¢˜

```javascript
// âŒ å›æº¯ç¾éš¾
/(a+)+b/.test('aaaaaaaaaaaaaaaaaaaaac');  // éå¸¸æ…¢

// âœ… ä¼˜åŒ–
/a+b/.test('aaaaaaaaaaaaaaaaaaaaac');
```

---

## ğŸ› ï¸ è°ƒè¯•å·¥å…·

| å·¥å…· | ç½‘å€ | ç‰¹ç‚¹ |
|------|------|------|
| regex101 | regex101.com | è¯¦ç»†è§£é‡Šã€å¤šè¯­è¨€ |
| regexr | regexr.com | å¯è§†åŒ–ã€ç¤¾åŒºæ¨¡å¼ |
| debuggex | debuggex.com | å›¾å½¢åŒ–å±•ç¤º |

---

## ğŸ“š æ ‡å¿—ä½

| æ ‡å¿— | å«ä¹‰ |
|------|------|
| `g` | å…¨å±€åŒ¹é… |
| `i` | å¿½ç•¥å¤§å°å†™ |
| `m` | å¤šè¡Œæ¨¡å¼ |
| `s` | è®© . åŒ¹é…æ¢è¡Œç¬¦ |
| `u` | Unicode æ¨¡å¼ |
| `y` | ç²˜æ€§åŒ¹é… |

```javascript
// ç»„åˆä½¿ç”¨
const regex = /pattern/gim;
```

---

æ­£åˆ™è¡¨è¾¾å¼å¾ˆå¼ºå¤§ï¼Œä½†ä¹Ÿè¦é€‚åº¦ä½¿ç”¨ã€‚ç®€å•çš„å­—ç¬¦ä¸²æ“ä½œç”¨åŸç”Ÿæ–¹æ³•å¯èƒ½æ›´æ¸…æ™°ã€‚
